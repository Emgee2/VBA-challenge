Sub multiple_year_stock_data()

Application.ScreenUpdating = False

Dim ticker As String

Dim ticker_total As Double
ticker_total = 0

Dim yearly_change As Double
yearly_change = 0

Dim percent_change As Double
percent_change = 0

Dim open_price As Double
Dim close_price As Double

Dim summary_table_row As Integer
summary_table_row = 2

For i = 2 To 759001

If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

ticker = Cells(i, 1).Value

ticker_total = ticker_total + Cells(i, 7).Value

Range("K" & summary_table_row).Value = ticker
Range("N" & summary_table_row).Value = ticker_total

summary_table_row = summary_table_row + 1

ticker_total = 0


Else

ticker_total = ticker_total + Cells(i, 7).Value

End If


If Cells(i + 1, 3).Value <> Cells(i, 3) Then

open_price = Cells(i, 3).Value

End If

If cells(i - ) <> Cells(i, 6) Then

close_price = Cells(i, 6).Value

yearly_change = close_price - open_price

Range("L" & summary_table_row).Value = yearly_change

yearly_change = 0

Else

yearly_change = close_price - open_price

End If


Next i



Application.ScreenUpdating = True


End Sub

