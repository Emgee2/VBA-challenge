Sub multiple_year_stock_data()

Application.ScreenUpdating = False

For Each ws In Worksheets

   Dim ticker As String

   Dim ticker_total As Double
   
   ticker_total = 0

   Dim yearly_change As Double
   
   Dim percent_change As Double
   
   Dim open_price As Double
  
   Dim close_price As Double

   Dim summary_table_row As Integer
   
   summary_table_row = 2
   
   lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row

For i = 2 To lastrow

   If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then

   ticker = ws.Cells(i, 1).Value

   ticker_total = ticker_total + ws.Cells(i, 7).Value

   ws.Range("H" & summary_table_row).Value = ticker
   
   ws.Range("K" & summary_table_row).Value = ticker_total

   summary_table_row = summary_table_row + 1

   ticker_total = 0


Else

   ticker_total = ticker_total + ws.Cells(i, 7).Value

End If

   If ws.Cells(i - 1, 1).Value <> ws.Cells(i, 1).Value Then

   open_price = ws.Cells(i, 3).Value

End If

   close_price = ws.Cells(i, 6).Value

   yearly_change = close_price - open_price

   precent_change = yearly_change / open_price * 100

   ws.Range("I" & summary_table_row).Value = yearly_change
   
   ws.Range("J" & summary_table_row).Value = percent_change
   
If ws.Cells(i, 9) > 0 Then
      
   ws.Cells(i, 9).Interior.ColorIndex = 4
      
End IF
   
If ws.Cells(i,9) < 0 Then
       
   ws.Cells(i, 9).Interior.ColorIndex = 3
    
End If
    
    
Next i
    
Next ws


   Application.ScreenUpdating = True


End Sub

