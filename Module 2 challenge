Sub multiple_year_stock_data()

'Set initial variable
Dim ws As Worksheet
Dim Ticker As String
Dim ticker_total As Double
Dim Yearly_change As Double
Dim Percent_change As Double

ticker_total = 0
Yearly_change = 0
Percent_change = 0

'Keep track of the location for each ticker in the summary table
Dim Summary_table_Row As Integer
Summary_table_Row = 2


'loop through all ticker
For i = 2 To 753001
For Each ws In ThisWorkbook.Worksheets

'Check if we are still within the same ticker name, if it is not...
If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then

'set the ticker
Ticker = Cells(i, 1).Value

ticker_total = ticker_total + Cells(i, 7).Value
Yearly_change = Cells(252, 6) - Cells(2, 3).Value

'print the ticker in the summary table
ws.Range("K" & Summary_table_Row).Value = Ticker

'Print the Volume Amount to the summary table
ws.Range("N" & Summary_table_Row).Value = ticker_total

'Pring the yearly change to the summary table
ws.Range("L" & Summary_table_Row).Value = Yearly_change

'Add one to the summary table row
Summary_table_Row = Summary_table_Row + 1

'Reset the ticker total
ticker_total = 0
Yearly_change = 0

'If the cell immediately following a row is the same ticker
Else

'Add to the Ticker total
ticker_total = ticker_total + Cells(i, 7).Value

'calculate yearly change


End If

Next ws

Next i


End Sub

